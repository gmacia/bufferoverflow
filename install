#!/bin/bash
# Fichero de instalacion para los scripts y ejemplos de buffer overflow

if [ "$EUID" -ne 0  ]
	then echo "Please run as root"
	exit
fi

echo [+] Updating GPG signatures
./firmas.sh


echo [+] Checking installed software
apt update
apt install -y gcc-multilib

echo [+] Installing pwntools
pip install --upgrade pip
pip install pwntools

echo [+] Installing PEDA
git clone https://github.com/longld/peda.git ~/peda
echo "source ~/peda/peda.py" >> ~/.gdbinit

echo [+] Changing file permissions 
chmod +x ./stackOverflow/x86/compile
chmod +x ./stackOverflow/x86/rop.py
chmod +x ./stackOverflow/x86/vuln_stack_nx
chmod +x ./stackOverflow/x86/vuln_stack_nonx
chmod +x ./stackOverflow/x86/overflow_example
chmod +x ./stackOverflow/x86/reto

echo [+] Creating symbolic link for vuln_stack executable
ln -s ./vuln_stack_nonx ./stackOverflow/x86/vuln

echo [+] Deactivating ASLR protection
echo 0 > /proc/sys/kernel/randomize_va_space
